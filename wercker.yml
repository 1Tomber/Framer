box: nolimitid/node-phantom-npm3

build:
    steps:
        - add-to-known_hosts:
            hostname: github.com
            fingerprint: 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48
        - script:
            name: load git revisions
            code: |
                ssh-keyscan github.com >> ~/.ssh/known_hosts
                cd $WERCKER_SOURCE_DIR
                git fetch --unshallow
        - script:
            name: set up permissions
            code: |
                export NODE_ENV=development
                chmod 777 -R .
                chmod 777 -R $WERCKER_CACHE_DIR
        - npm-test

deploy:
    steps:
        - script:
            name: set up permissions
            code: |
                export NODE_ENV=development
                chmod 777 -R .
                chmod 777 -R $WERCKER_CACHE_DIR
        - install-packages:
            packages: zip
        - script:
            name: builds.framerjs.com
            code: make deploy

# $WERCKER_OUTPUT_DIR